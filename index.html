<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“‹ Scrapboxæ—¥å ±ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ v2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; margin: 20px; }
    label { display: block; margin-top: 10px; }
    input, select, textarea { width: 100%; padding: 5px; margin-top: 4px; }
    textarea { height: 60px; }
    .output, .preview { white-space: pre-wrap; background: #f9f9f9; padding: 10px; margin-top: 20px; border: 1px solid #ccc; }
    .flex { display: flex; gap: 10px; flex-wrap: wrap; }
    .inline { display: inline-block; margin-right: 10px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>ğŸ“‹ Scrapboxæ—¥å ±ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ v2</h1>

  <label>ç·è©•: <input type="text" id="summary"></label>

  <h3>å¤©æ°—</h3>
  <div class="flex">
    <label>å¤©æ°—: 
      <select id="weather">
        <option value="â˜€ï¸">â˜€ï¸</option><option value="ğŸŒ¤ï¸">ğŸŒ¤ï¸</option><option value="â˜ï¸">â˜ï¸</option>
        <option value="ğŸŒ§ï¸">ğŸŒ§ï¸</option><option value="â›ˆï¸">â›ˆï¸</option><option value="â„ï¸">â„ï¸</option>
      </select>
    </label>
    <label>æ°—æ¸©ï¼ˆâ„ƒï¼‰: <input type="number" id="temp" min="-10" max="50"></label>
    <label>ä½“æ„Ÿ: <input type="text" id="feeling"></label>
  </div>

  <h3>ç¡çœ </h3>
  <div class="flex">
    <label>å°±å¯: <input type="time" id="sleepTime" step="1800"></label>
    <label>èµ·åºŠ: <input type="time" id="wakeTime" step="1800"></label>
    <div id="sleepPreview" class="inline"></div>
  </div>
  <label>è³ªï¼ˆ1ã€œ5ptï¼‰: 
    <select id="sleepQuality">
      <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
    </select>
  </label>

  <h3>é£Ÿäº‹</h3>
  <div class="flex">
    <label>æœ <input type="checkbox" id="mealMorning"></label>
    <label>æ˜¼ <input type="checkbox" id="mealNoon"></label>
    <label>å¤• <input type="checkbox" id="mealEvening"></label>
  </div>

  <label>å…¥æµ´: 
    <select id="bath">
      <option value="ãªã—">ãªã—</option>
      <option value="ã‚·ãƒ£ãƒ¯ãƒ¼">ã‚·ãƒ£ãƒ¯ãƒ¼</option>
      <option value="æ¹¯èˆ¹">æ¹¯èˆ¹</option>
    </select>
  </label>

  <h3>ä½“èª¿</h3>
  <label>AMã‚¹ã‚³ã‚¢: 
    <select id="condAM">
      <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
    </select>
  </label>
  <label>PMã‚¹ã‚³ã‚¢: 
    <select id="condPM">
      <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
    </select>
  </label>
  <label>è‡ªç”±è¨˜è¿°: <textarea id="condNote"></textarea></label>

  <h3>ç—‡çŠ¶</h3>
  <div id="symptomsContainer" class="flex">
    <label><input type="checkbox" value="å€¦æ€ æ„Ÿ">å€¦æ€ æ„Ÿ</label>
    <label><input type="checkbox" value="çœ æ°—">çœ æ°—</label>
    <label><input type="checkbox" value="å‹•æ‚¸">å‹•æ‚¸</label>
    <label><input type="checkbox" value="è„‚æ±—">è„‚æ±—</label>
    <label><input type="checkbox" value="æ‰‹ã®éœ‡ãˆ">æ‰‹ã®éœ‡ãˆ</label>
    <label><input type="checkbox" value="ç„¦ç‡¥æ„Ÿ">ç„¦ç‡¥æ„Ÿ</label>
    <label><input type="checkbox" value="é ­ç—›">é ­ç—›</label>
    <label><input type="checkbox" value="ãƒ‘ãƒ‹ãƒƒã‚¯ç™ºä½œ">ãƒ‘ãƒ‹ãƒƒã‚¯ç™ºä½œ</label>
    <label><input type="checkbox" id="symptomOtherCheck">ãã®ä»–</label>
    <input type="text" id="symptomOtherText" class="hidden" placeholder="ãã®ä»–ã®ç—‡çŠ¶">
  </div>

  <h3>ãƒ‡ãƒ‘ã‚¹</h3>
  <label>æœç”¨é‡ï¼ˆTï¼‰: 
    <select id="depas">
      <option value="0">0</option><option value="1">1</option><option value="2">2</option>
      <option value="3">3</option><option value="4">4</option><option value="5">5</option>
      <option value="6">6</option>
    </select>
    <span id="depasPreview" class="inline"></span>
  </label>

  <h3>å—œå¥½å“</h3>
  <label>
    <select id="beverageType">
      <option value="ã‚«ãƒ•ã‚§ã‚¤ãƒ³">ã‚«ãƒ•ã‚§ã‚¤ãƒ³</option>
      <option value="ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«">ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«</option>
      <option value="å–«ç…™">å–«ç…™</option>
      <option value="ãã®ä»–">ãã®ä»–</option>
    </select>
  </label>
  <input type="text" id="beverageOther" class="hidden" placeholder="ãã®ä»–ã®å†…å®¹">

  <h3>ãµã‚Šã‹ãˆã‚Š</h3>
  <label>æ°—åˆ†: <input type="text" id="mood"></label>
  <label>ã‚¹ã‚³ã‚¢ï¼ˆ1ã€œ5ptï¼‰: 
    <select id="moodScore">
      <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
    </select>
  </label>

  <button onclick="generate()">ğŸ“‹ å‡ºåŠ›ã‚’ç”Ÿæˆ</button>

  <div class="output" id="outputArea"></div>
  <div class="preview" id="previewArea"></div>

  <script>
    document.getElementById("sleepTime").addEventListener("change", updateSleepPreview);
    document.getElementById("wakeTime").addEventListener("change", updateSleepPreview);
    document.getElementById("depas").addEventListener("change", updateDepasPreview);
    document.getElementById("symptomOtherCheck").addEventListener("change", function() {
      document.getElementById("symptomOtherText").classList.toggle("hidden", !this.checked);
    });
    document.getElementById("beverageType").addEventListener("change", function() {
      document.getElementById("beverageOther").classList.toggle("hidden", this.value !== "ãã®ä»–");
    });

    function updateSleepPreview() {
      const val = calculateSleepHours();
      document.getElementById("sleepPreview").textContent = val ? `= ${val}h` : "";
    }

    function updateDepasPreview() {
      const t = parseInt(document.getElementById("depas").value);
      document.getElementById("depasPreview").textContent = `= ${(t * 0.5).toFixed(1)}mg`;
    }

    function calculateSleepHours() {
      const start = document.getElementById('sleepTime').value;
      const end = document.getElementById('wakeTime').value;
      if (!start || !end) return '';
      const [sh, sm] = start.split(':').map(Number);
      const [eh, em] = end.split(':').map(Number);
      let startMin = sh * 60 + sm, endMin = eh * 60 + em;
      if (endMin <= startMin) endMin += 1440;
      return Math.floor((endMin - startMin) / 60);
    }

    function generate() {
      const s = id => document.getElementById(id).value;
      const sc = id => document.getElementById(id).checked;
      const hours = calculateSleepHours();
      const symptoms = [...document.querySelectorAll("#symptomsContainer input[type=checkbox]")]
        .filter(cb => cb.checked && cb.value).map(cb => cb.value);
      if (document.getElementById("symptomOtherCheck").checked) {
        symptoms.push(document.getElementById("symptomOtherText").value);
      }
      const depas = parseInt(s("depas")), depasMg = (depas * 0.5).toFixed(1);
      const bevType = s("beverageType");
      const beverage = bevType === "ãã®ä»–" ? document.getElementById("beverageOther").value : bevType;

      const text = `[** ğŸ“‹ æ¦‚è¦ãƒ­ã‚°]
 ç·è©•: \`${s("summary")}\`
 å¤©æ°—: \`${s("weather")}, æ—¥ä¸­${s("temp")}â„ƒ, ${s("feeling")}\`
 ç¡çœ : \`${hours}h\` è³ª: \`${s("sleepQuality")}/5pt\`
 é£Ÿäº‹: æœ\`${sc("mealMorning") ? "â—¯" : "â˜“"}\`ï½œæ˜¼\`${sc("mealNoon") ? "â—¯" : "â˜“"}\`ï½œå¤•\`${sc("mealEvening") ? "â—¯" : "â˜“"}\`
 å…¥æµ´: \`${s("bath")}\`
 ä½“èª¿: \`AM:${s("condAM")}/5pt\`ï½œ\`PM:${s("condPM")}/5pt\`
  ${s("condNote")}
 ç—‡çŠ¶: \`${symptoms.join(",")}\`
 ãƒ‡ãƒ‘ã‚¹(0.5mg): \`${depas}T/d\` = \`${depasMg}mg/d\`
 å—œå¥½å“: \`${beverage}\`
 [* ãµã‚Šã‹ãˆã‚Šæ™‚ã®æ°—åˆ† (æƒ…ç·’ã®çµ‚ç€ç‚¹)]
  æ°—åˆ†: \`${s("mood")}\`
  score: \`${s("moodScore")}/5pt\``;

      document.getElementById("outputArea").textContent = text;
      document.getElementById("previewArea").innerHTML = text.replace(/`([^`]+)`/g, "<code>$1</code>").replace(/\n/g, "<br>");
    }
  </script>
</body>
</html>
